version: "3.7"

services:
  app:
    build: .
    ports:
      - "8000:8000"
    environment:
      MARIADB_ROOT_PASSWORD: "${MARIADB_ROOT_PASSWORD}"
      SITE_NAME: "${SITE_NAME}"
      ADMIN_PASSWORD: "${ADMIN_PASSWORD}"
      OPENAI_API_KEY: "${OPENAI_API_KEY}"
      GPT_APP_GIT: "${GPT_APP_GIT}"
    command: >
      bash -c "
        echo 'ðŸ§ª Starte Debug-Modus';
        env;
        echo 'âœ… ENV-Variablen angezeigt';
        ls -alh;
        echo 'âœ… Verzeichnisinhalt angezeigt';
        sleep 300"
    depends_on:
      - mariadb
      - redis-cache
      - redis-queue
      - redis-socketio
    volumes:
      - sites:/home/frappe/frappe-bench/sites

  mariadb:
    image: mariadb:10.6
    environment:
      MARIADB_ROOT_PASSWORD: ${MARIADB_ROOT_PASSWORD}

  redis-cache:
    image: redis:7-alpine
  redis-queue:
    image: redis:7-alpine
  redis-socketio:
    image: redis:7-alpine

volumes:
  mariadb:
  sites:
